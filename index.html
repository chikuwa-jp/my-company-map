<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥çµŒ225 æ‹ ç‚¹ãƒãƒƒãƒ—</title>
    <meta name="description" content="æ—¥çµŒå¹³å‡æ ªä¾¡æ¡ç”¨225éŠ˜æŸ„ã®ä¸»è¦æ‹ ç‚¹ãƒ»æœ¬ç¤¾æ‰€åœ¨åœ°ã‚’åœ°å›³ä¸Šã«ãƒ—ãƒ­ãƒƒãƒˆ">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        #map { height: 600px; width: 100%; border-radius: 12px; z-index: 10; }
        .leaflet-popup-content-wrapper { border-radius: 8px; font-family: sans-serif; }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-900 flex flex-col min-h-screen">

    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <nav class="bg-indigo-700 text-white shadow-lg sticky top-0 z-[2000]">
        <div class="max-w-6xl mx-auto px-4 h-14 flex items-center">
            <div class="flex items-center gap-2">
                <span class="text-xl">ğŸ—¾</span>
                <span class="font-bold tracking-tighter text-lg">æ—¥çµŒ225 æ‹ ç‚¹ãƒãƒƒãƒ—</span>
            </div>
        </div>
    </nav>

    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <header class="bg-white border-b py-10 px-4 text-center">
        <h1 class="text-3xl font-extrabold text-gray-900 mb-4">æ—¥çµŒ225 æ‹ ç‚¹ãƒãƒƒãƒ—</h1>
        <p class="text-gray-600 max-w-2xl mx-auto text-base leading-relaxed">
            æ—¥çµŒå¹³å‡æ ªä¾¡ã«æ¡ç”¨ã•ã‚Œã‚‹225ã®ä¸»è¦ä¼æ¥­<br>
            æ‹ ç‚¹é…ç½®ã‚’åœ°å›³ä¸Šã§ä¿¯ç°ã—ã€ãƒ“ã‚¸ãƒã‚¹æ§‹é€ ã‚„åœ°åŸŸçµŒæ¸ˆã¸ã®å½±éŸ¿ã‚’åˆ†æã™ã‚‹ãŸã‚ã®ãƒãƒƒãƒ—
        </p>
        
        <!-- æ¤œç´¢ãƒãƒ¼ -->
        <div class="relative mt-8 max-w-xl mx-auto">
            <div class="flex items-center bg-gray-50 rounded-full px-5 py-1 border-2 border-indigo-500 focus-within:ring-4 focus-within:ring-indigo-100 transition">
                <svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                <input type="text" id="search-input" placeholder="ä¼æ¥­åã€è¨¼åˆ¸ã‚³ãƒ¼ãƒ‰ã§æ¤œç´¢..." class="bg-transparent border-none w-full p-3 text-base focus:outline-none" autocomplete="off">
            </div>
            <div id="search-results" class="absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-gray-100 overflow-hidden z-[3000] hidden"></div>
        </div>
    </header>

    <main class="flex-grow max-w-6xl mx-auto w-full px-4 py-8">
        <div class="flex flex-col gap-8">
            
            <!-- åœ°å›³ã‚¨ãƒªã‚¢ -->
            <div class="space-y-6">
                <div class="bg-white p-2 rounded-2xl shadow-sm border border-gray-200 relative">
                    <div id="map"></div>
                    <div id="map-overlay" class="absolute bottom-6 left-6 z-[1000] bg-white/90 backdrop-blur px-3 py-2 rounded-lg shadow-sm border text-[11px] font-bold text-gray-600">
                        ãƒ—ãƒ­ãƒƒãƒˆæ•°: <span id="count-num" class="text-indigo-600">0</span> æ‹ ç‚¹
                    </div>
                </div>

                <!-- æ¥­ç¨®åˆ¥ã‚¯ã‚¤ãƒƒã‚¯ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                <div class="flex flex-wrap items-center gap-2 py-2">
                    <span class="text-xs font-bold text-gray-400 mr-2 flex items-center">æ¥­ç¨®ã§çµã‚Šè¾¼ã¿:</span>
                    <button onclick="filterBySector('é›»æ°—æ©Ÿå™¨')" class="px-4 py-1.5 bg-white border rounded-full text-xs hover:bg-indigo-50 transition border-indigo-100 shadow-sm">é›»æ°—æ©Ÿå™¨</button>
                    <button onclick="filterBySector('è‡ªå‹•è»Š')" class="px-4 py-1.5 bg-white border rounded-full text-xs hover:bg-indigo-50 transition border-indigo-100 shadow-sm">è‡ªå‹•è»Š</button>
                    <button onclick="filterBySector('æƒ…å ±ãƒ»é€šä¿¡')" class="px-4 py-1.5 bg-white border rounded-full text-xs hover:bg-indigo-50 transition border-indigo-100 shadow-sm">æƒ…å ±ãƒ»é€šä¿¡</button>
                    <button onclick="filterBySector('ã‚µãƒ¼ãƒ“ã‚¹')" class="px-4 py-1.5 bg-white border rounded-full text-xs hover:bg-indigo-50 transition border-indigo-100 shadow-sm">ã‚µãƒ¼ãƒ“ã‚¹</button>
                    <button onclick="filterBySector('all')" class="px-4 py-1.5 bg-gray-100 border rounded-full text-xs hover:bg-gray-200 transition border-gray-200 shadow-sm">ã™ã¹ã¦è¡¨ç¤º</button>
                </div>
            </div>

            <!-- ä¸‹éƒ¨ï¼šãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ -->
            <section class="bg-white p-8 rounded-2xl shadow-sm border border-gray-200">
                <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="text-sm text-gray-600 leading-relaxed space-y-3">
                        <p>
                            æœ¬ãƒãƒƒãƒ—ã¯ã€å„ä¼æ¥­ãŒå…¬é–‹ã—ã¦ã„ã‚‹æœ‰ä¾¡è¨¼åˆ¸å ±å‘Šæ›¸ã‚„å…¬å¼ã‚µã‚¤ãƒˆã®æ‹ ç‚¹æƒ…å ±ã‚’å…ƒã«ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚
                            æ—¥çµŒå¹³å‡æ ªä¾¡ï¼ˆæ—¥çµŒ225ï¼‰ã«æ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ä¼æ¥­ã®ã€Œä¸»è¦ãªè¨­å‚™ã®çŠ¶æ³ã€ã‚’å¯è¦–åŒ–ã™ã‚‹ã“ã¨ã§ã€æ—¥æœ¬ã®ç”£æ¥­é›†ç©åœ°ã®åˆ†å¸ƒã‚’ç¢ºèªã§ãã¾ã™ã€‚
                        </p>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-xl border-l-4 border-amber-400 text-amber-900 text-xs">
                        <p class="font-bold mb-2 text-sm italic">ã€ã”åˆ©ç”¨ã«ã‚ãŸã£ã¦ã®æ³¨æ„ã€‘</p>
                        <ul class="list-disc list-inside space-y-1">
                            <li>ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã‚Šã€æœ€æ–°ã®æ‹ ç‚¹çŠ¶æ³ï¼ˆç§»è»¢ãƒ»é–‰é–ç­‰ï¼‰ã¨ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</li>
                            <li>åº§æ¨™æƒ…å ±ã¯ä½æ‰€ã‹ã‚‰ã®è‡ªå‹•å¤‰æ›ã§ã‚ã‚‹ãŸã‚ã€å³å¯†ãªæ•·åœ°ä½ç½®ã¨ã‚ãšã‹ã«ã‚ºãƒ¬ãŒç”Ÿã˜ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</li>
                            <li>é‡è¦ãªåˆ¤æ–­ã‚’è¡Œã†éš›ã¯ã€å¿…ãšå„ä¼æ¥­ã®å…¬å¼ã‚µã‚¤ãƒˆã‚„æœ€æ–°ã®æ³•å®šæ›¸é¡ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-white border-t py-8 px-4 mt-auto">
        <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="text-left">
                <div class="font-bold text-gray-900 text-sm">æ—¥çµŒ225 æ‹ ç‚¹ãƒãƒƒãƒ—</div>
            </div>
            <p class="text-[10px] text-gray-400">&copy; 2024 Corporate Map Project</p>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const map = L.map('map', { scrollWheelZoom: false }).setView([36.2048, 138.2529], 5);
        map.on('click', () => { map.scrollWheelZoom.enable(); });

        let allMarkers = {}; 
        let companyData = []; 
        let markerLayer = L.layerGroup().addTo(map);
        
        L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://maps.gsi.go.jp/development/ichiran.html">å›½åœŸåœ°ç†é™¢</a>'
        }).addTo(map);

        async function loadData() {
            try {
                const response = await fetch('locations.json');
                companyData = await response.json();
                renderMarkers(companyData);
            } catch (e) {
                console.error("ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:", e);
            }
        }

        function renderMarkers(data) {
            markerLayer.clearLayers();
            allMarkers = {};
            let count = 0;

            data.forEach(item => {
                if (item.lat && item.lng) {
                    const marker = L.marker([item.lat, item.lng]);
                    marker.bindPopup(`
                        <div class="font-sans p-1">
                            <div class="text-[10px] text-indigo-600 font-bold mb-0.5">${item.sector || ''}</div>
                            <h3 class="font-bold text-sm border-b pb-1 mb-1">${item.name}</h3>
                            <p class="text-[10px] text-gray-500 mb-1">${item.address}</p>
                            <div class="text-[10px] font-mono text-gray-400">Code: ${item.code || '----'}</div>
                        </div>
                    `);
                    marker.addTo(markerLayer);
                    allMarkers[item.name] = marker;
                    count++;
                }
            });
            document.getElementById('count-num').innerText = count;
        }

        function filterBySector(sector) {
            if (sector === 'all') {
                renderMarkers(companyData);
            } else {
                const filtered = companyData.filter(item => item.sector && item.sector.includes(sector));
                renderMarkers(filtered);
            }
        }

        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results');
        
        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.trim().toLowerCase();
            if (!query) { searchResults.style.display = 'none'; return; }
            const filtered = companyData.filter(item => 
                (item.name && item.name.toLowerCase().includes(query)) || 
                (item.code && item.code.toString().includes(query))
            ).slice(0, 5);

            if (filtered.length > 0) {
                searchResults.innerHTML = filtered.map(item => `
                    <div class="p-3 hover:bg-gray-50 cursor-pointer border-b flex justify-between items-center transition" onclick="moveToMarker('${item.name}')">
                        <span class="text-sm font-bold text-gray-700">${item.name}</span>
                        <span class="text-[10px] bg-gray-100 px-2 py-1 rounded text-gray-500">${item.code || '-'}</span>
                    </div>
                `).join('');
                searchResults.style.display = 'block';
            } else {
                searchResults.style.display = 'none';
            }
        });

        window.moveToMarker = (name) => {
            const marker = allMarkers[name];
            if (marker) {
                map.setView(marker.getLatLng(), 15);
                marker.openPopup();
            }
            searchResults.style.display = 'none';
            searchInput.value = name;
        };

        window.onload = loadData;
    </script>
</body>
</html>